<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agendamento de Consultas</title>
</head>
<body>
    <h1>Agendamento de Consultas</h1>
    
    <form id="appointment-form">
        <label for="name">Nome:</label>
        <input type="text" id="name" required><br><br>

        <label for="email">E-mail:</label>
        <input type="email" id="email" required><br><br>

        <label for="date">Data:</label>
        <input type="date" id="date" required><br><br>

        <label for="time">Horário:</label>
        <input type="time" id="time" required><br><br>

        <label for="duration">Duração (em minutos):</label>
        <input type="number" id="duration" required min="15"><br><br>

        <input type="submit" value="Agendar Consulta">
    </form>

    <div id="confirmation"></div>

    <script>
        // Carrega a API do Google Client
        function loadGoogleAPI() {
            gapi.load('client:auth2', initGoogleClient);
        }

        function initGoogleClient() {
            gapi.client.init({
                apiKey: 'YOUR_API_KEY',
                clientId: 'YOUR_CLIENT_ID',
                discoveryDocs: ["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"],
                scope: "https://www.googleapis.com/auth/calendar.events"
            }).then(function () {
                // Lidar com autenticação
                gapi.auth2.getAuthInstance().signIn().then(function () {
                    console.log('Autenticado');
                });
            });
        }

        // Função para adicionar evento à Google Calendar
        function addEventToCalendar(event) {
            var request = gapi.client.calendar.events.insert({
                'calendarId': 'gabriel@franceschi.com.br',
                'resource': event
            });

            request.execute(function (event) {
                document.getElementById('confirmation').innerHTML = 'Consulta agendada com sucesso: ' + event.htmlLink;
            });
        }

        document.getElementById('appointment-form').addEventListener('submit', function (e) {
            e.preventDefault();

            var name = document.getElementById('name').value;
            var email = document.getElementById('email').value;
            var date = document.getElementById('date').value;
            var time = document.getElementById('time').value;
            var duration = document.getElementById('duration').value;

            var event = {
                'summary': 'Consulta com ' + name,
                'description': 'Consulta agendada por ' + email,
                'start': {
                    'dateTime': date + 'T' + time + ':00',
                    'timeZone': 'America/Sao_Paulo'
                },
                'end': {
                    'dateTime': date + 'T' + time + ':00',
                    'timeZone': 'America/Sao_Paulo'
                },
                'attendees': [{'email': email}],
                'reminders': {
                    'useDefault': false,
                    'overrides': [
                        {'method': 'email', 'minutes': 24 * 60},
                        {'method': 'popup', 'minutes': 10}
                    ]
                }
            };

            addEventToCalendar(event);
        });

        // Inicia a API do Google ao carregar a página
        loadGoogleAPI();
    </script>

    <script async defer src="https://apis.google.com/js/api.js"></script>
</body>
</html>
